

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>47. Security &#8212; Introduction to Operating Systems</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'sec/sec';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="48. How to read this book" href="../misc/howto.html" />
    <link rel="prev" title="46. Virtualization" href="../virt/virt.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro/pref.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro/pref.html">
                    Preface
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/purpose.html">2. Purpose of operating systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/structure.html">3. Operating System Structure &amp; Unix/Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/abstractions.html">4. Operating System Abstractions</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro/tools.html">5. What you should know</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-shell.html">5.1. Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-editors.html">5.2. Editors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-make.html">5.3. Makefiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-git.html">5.4. Git Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-gdb.html">5.5. GDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-c.html">5.6. The C Programming Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-testing.html">5.7. Unit Tests</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Virtual Processor</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../scheduling/intro.html">6. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/process.html">7. Virtualizing a CPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/scheduling.html">8. Scheduling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/real_sched.html">9. A Look at the Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/review.html">10. Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">File Systems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../fs/intro.html">11. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/interface.html">12. File System Abstraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/diskhw.html">13. A bit about Disks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/disklayout.html">14. File System Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/dl_track_used.html">15. Disk Layout:Tracking Used Space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/dl_track_free.html">16. Disk Layout:Tracking Free Space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/dl_name.html">17. Disk Layout:Implementing Name Space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/dl_failures.html">18. Disk Layout:Dealing with Failures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/dl_ex_exx.html">19. Disk Layout:Examples of Real World File Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/kernelimp.html">20. Kernel implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/review.html">21. Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Virtual Memory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../mm/intro.html">22. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/phys-and-seg.html">23. Memory management before paged virtual memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/virt-paging.html">24. Paging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/page-tables.html">25. Page Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/reclamation.html">26. Memory reclaiming algorithms.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/page-size.html">27. Page Sizes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/misc.html">28. Other topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/buffer-cache.html">29. Buffer Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/pagefaults.html">30. Memory Management Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/realworld.html">31. Memory management in the real world</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/concl.html">32. Conclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/review.html">33. Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concurrency</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sync/sync.html">34. Introduction to Concurrency, Synchronization and Deadlock</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/sharing.html">35. Cooperating Processes and Inter-process Communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/criticalsection.html">36. The Critical Section Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/locks.html">37. Implementing Locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/ordering.html">38. Ordering Thread Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/concurrency_bugs.html">39. Common Concurrency Bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/readmostly.html">40. Read-Dominated Workloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/hardware_challenges.html">41. Challenges of Modern Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/linux_locking.html">42. Locking in the Linux Kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/review.html">43. Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other Topics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../devices/devices.html">44. Input and Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devices/disk2.html">45. More on Disks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/virt.html">46. Virtualization</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">47. Security</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../misc/howto.html">48. How to read this book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/Contributing.html">49. Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/bib.html">50. Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://jupyterhub-opf-jupyterhub.apps.smaug.na.operate-first.cloud/hub/user-redirect/git-pull?repo=https%3A//github.com/OpenOSOrg/openos&urlpath=lab/tree/openos/content/sec/sec.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/OpenOSOrg/openos" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/OpenOSOrg/openos/edit/main/content/sec/sec.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/OpenOSOrg/openos/issues/new?title=Issue%20on%20page%20%2Fsec/sec.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/sec/sec.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Security</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#protection">47.1. Protection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identity-and-authentication">47.1.1. Identity and Authentication</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-passwords">47.1.2. Checking passwords</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#centralized-authentication-ldap-and-kerberos">47.1.3. Centralized authentication - LDAP and Kerberos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unix-access-control">47.2. Unix Access Control</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations-of-unix-permissions">47.2.1. Limitations of Unix permissions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-control-lists">47.2.2. Access Control Lists</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-control-list-examples">47.2.3. Access Control List Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#other-privileged-operations">47.2.4. Other Privileged Operations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selinux">47.3. SELinux</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#control-of-information-flow">47.3.1. Control of Information Flow</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#review-questions">47.3.1.1. Review Questions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attacks-stack-overflow">47.4. Attacks — Stack Overflow</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#security-sql-injection">47.4.1. Security - SQL Injection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ssl-and-connection-security">47.4.2. SSL and Connection Security</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="security">
<h1><span class="section-number">47. </span>Security<a class="headerlink" href="#security" title="Permalink to this headline">#</a></h1>
<p>The term computer security covers a number of areas and goals. Most of
them fall under the following categories:</p>
<ul class="simple">
<li><p>Confidentiality of data. As a user of a computer system, this allows you
to prevent others from accessing information which you wish to keep
private, such as email or passwords.</p></li>
<li><p>Confidentiality of actions. This lets you prevent others from observing
what programs you run and what files or external resources you access.</p></li>
<li><p>Integrity of data. Your data will not be modified or deleted without
your permission.</p></li>
<li><p>Integrity of operations. Commands should do what they are supposed to
do. For example, when you type ls you should get a directory listing,
rather than a script that sends your passwords to a secret website in
Russia.</p></li>
<li><p>Availability. A system will not stop running when you need it to be
operational.</p></li>
</ul>
<p>With the rise of the Internet, security has become a much broader field,
much of it related to either networking or the behavior of applications
such as web browsers. This chapter will cover operating system features
which enable computer security, and which reduce the risks from security
flaws in application software; the field of computing security is much
larger, however<a class="footnote-reference brackets" href="#id12" id="id1">1</a>.</p>
<section id="protection">
<h2><span class="section-number">47.1. </span>Protection<a class="headerlink" href="#protection" title="Permalink to this headline">#</a></h2>
<p>Much of security involves protection: deciding whether or not to allow
an operation based on a series of rules. The purpose of protection is to
ensure the security goals described above, by applying these rules to
computing operations, allowing some operations and forbiding others.
(This is not sufficient for full security, as seen in the discussion
below of software vulnerabilities, but it helps.) These rules are
typically based on a simple model, of actors, objects, and actions:</p>
<ul class="simple">
<li><p>Actors. These perform the actions. At the lowest level these are almost
always processes, but they are typically identified by a text or numeric
user ID, which is typically associated with either an actual person or a
system service.</p></li>
<li><p>Objects. These are the things which are being protected: usually files
or directories, but sometimes processes, special devices,
configurations, or other aspects of the system which can be modified.</p></li>
<li><p>Actions. These are performed on objects. The most common actions are
read and write, but others can include creating and deleting files,
killing a process, or rebooting the system.</p></li>
</ul>
<p>The goal of the operating system’s protection or <em>access control</em>
mechanisms is to express and enforce policies which determine whether a
particular combination of an actor performing an action on an object is
to be allowed or denied.</p>
<section id="identity-and-authentication">
<h3><span class="section-number">47.1.1. </span>Identity and Authentication<a class="headerlink" href="#identity-and-authentication" title="Permalink to this headline">#</a></h3>
<p>In a Unix-like operating system, the actual actors are processes, which
perform actions by issuing system calls. However specifying rules based
on the processes themselves—e.g. process 10 may access file
<code class="docutils literal notranslate"><span class="pre">&quot;/home/pjd&quot;</span></code>—will not work, because processes are created
dynamically: rules could only be made for processes in existence at that
time, and not for ones created in the future.</p>
<p>The solution used in almost all operating systems today is the concept
of <em>user identity</em>: every process is associated with a user identity
(e.g. a user name and ID in Unix) and rules are specified in terms of
these identities. In its simplest form each of these identities is a
login name associated with an individual person, and rules for that
identity are used to permit or restrict access by that person<a class="footnote-reference brackets" href="#id13" id="id2">2</a>. User
identity is inherited through the <code class="docutils literal notranslate"><span class="pre">fork</span></code> system call, so that actions
taken by a process either directly or indirectly (through children of
that process) are bound by the same rules. Access rules specify actors
in terms of these identities, and every process is associated with one
of these identities, allowing a fixed mapping from identities to
permissions.</p>
<aside class="sidebar">
<p>These authentication mechanisms are frequently called <em>factors</em>; hence
the term <em>multi-factor authentication</em>, where more than one factor (e.g.
password, text message) are used. The Wikipedia entry on “Multi-factor
authentication” is a good introduction.</p>
</aside>
<p>In practice this requires a login process, or <em>authentication</em>, in which
an external user proves that she has the right to take on a certain
identity. Thus, the person Jane Smith may be given the right to use the
operating system identity named <code class="docutils literal notranslate"><span class="pre">smith.j</span></code>, after <em>authenticating</em> that
identity to the system by providing the correct password. Authentication
is an important part of operating system security, as it forms the link
between the higher-level goals of system administration (e.g. Jane is
allowed to access <em>file.txt</em>, but Joe isn’t) and the operating
system-level features which implement this control.</p>
<p>Most authentication mechanisms can be classified as one of three types,
based on the type of verification provided by the user:</p>
<ol class="arabic simple">
<li><p><em>Something you know</em>: e.g. a password. This is the most common form of
authentication, due to ease of implementation.</p></li>
<li><p><em>Something you have</em>: like a key to a lock, an RSA SecurID token, etc.
More complicated to administer, but more difficult for an adversary to
obtain.</p></li>
<li><p><em>Something you are</em>: often biometric data, such as a fingerprint.</p></li>
</ol>
<p>You have undoubtedly used many password-authenticated processes; in
addition you may have used other methods such as a SecureID token or
fingerprint scanner. There are advantages and disadvantages to each type
of authentication; however this class focuses on passwords as they are
the most widely used.</p>
</section>
<section id="checking-passwords">
<h3><span class="section-number">47.1.2. </span>Checking passwords<a class="headerlink" href="#checking-passwords" title="Permalink to this headline">#</a></h3>
<p>Securely storing and checking passwords is difficult, and various
methods have been used over the years. The primary alternatives are as
follows.</p>
<p><strong>Unencrypted file</strong>: Passwords are stored In an unencrypted file, only
accessible to the operating system or a privileged user, and a simple
string compare is used to verify a user-entered password. Although in
principle this should be secure, the result of any error or failure is
catastrophic. (This issue is particularly problematic since people
typically re-use passwords across systems.)</p>
<p><strong>Hashed password file</strong>: Passwords are put through a one-way
cryptographic hash function<a class="footnote-reference brackets" href="#id14" id="id3">3</a> before being stored. User-entered
passwords are hashed by the same algorithm and compared with the stored
password hash; if the two match, then the password is correct. Early
UNIX systems used this mechanism, and made the password file
publicly-readable, as the same file held other information (e.g. mapping
between numeric user ID and text username) used by many unprivileged
programs. (e.g. the <strong>ls -l</strong> command would need this mapping to show
file ownership.) This was considered fairly secure on slow (and
especially non-networked) machines, due to the length of time required
to crack an individual password by <em>brute force</em>—i.e. trying all
possible combinations until the correct password was found. However the
discovery of <em>dictionary attacks</em> changed this, however.</p>
<p>A dictionary attack is based on the idea that in most cases breaking
into <em>any</em> account is almost as good as breaking a particular account,
and takes advantage of the fact that on shared machines (e.g.
<strong><a class="reference external" href="http://login.ccs.neu.edu">login.ccs.neu.edu</a></strong>) there are a large number of user accounts,
increasing the chance of breaking into one of them. The attack consists
of calculating the hash for every word in a dictionary<a class="footnote-reference brackets" href="#id15" id="id4">4</a>, and then
comparing this list with the hashes in the password file; if <em>any</em> of
the accounts has a password in this list, the attack succeeds. (a more
sophisticated attack, using pre-computed <em>rainbow tables</em><a class="footnote-reference brackets" href="#id16" id="id5">5</a> is able to
crack individual hashed passwords very quickly, as well.)</p>
<p><strong>Password “salt”</strong>: This is a variation on hashed passwords—when a
password is stored, a random string S is chosen (for unknown reasons
called the <em>salt</em>) and appended to the password before hashing ; the
stored value is then [S, hash(S+password)]. Verifying a password is
straightforward: the salt value is read from the password file and
appended to the input password before it is hashed and compared. This
protects against attacks which require pre-computed tables (e.g.
dictionary and rainbow table attacks), as now tables would be needed for
every possible salt value. (in early usage this was 12 bits long; in
modern systems it is 32 bits or more.)</p>
<p>As machines (especially GPUs) become faster and faster, even this method
has become less secure over time, as it is becoming feasible for
attackers to evaluate billions of possible passwords per second.
Counter-measures include making the hash function slower (e.g. running
the password through the hash function 5000 times), and protecting the
password file against public access, just like was done with early
plain-text password files. (this is done in Linux— <code class="docutils literal notranslate"><span class="pre">/etc/passwd</span></code>
contains username and UID information, and is publicly readable, while
<code class="docutils literal notranslate"><span class="pre">/etc/shadow</span></code> contains password hashes and is protected.</p>
<div class="literal-block-wrapper docutils container" id="shadowpw">
<div class="code-block-caption"><span class="caption-number">Listing 47.1 </span><span class="caption-text">Password and shadow password files in Linux</span><a class="headerlink" href="#shadowpw" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pjd@cs5600-vbox:~$ ls -l /etc/shadow /etc/passwd
-rw-r--r-- 1 root root   1061 Aug 24  2013 /etc/passwd
-rw-r----- 1 root shadow  867 Aug 24  2013 /etc/shadow
pjd@cs5600-vbox:~$ tail -2 /etc/passwd
student:x:1000:1000:A,,,:/home/student:/bin/bash
pjd:x:1001:1001:Peter Desnoyers,,,:/home/pjd:/bin/bash
pjd@cs5600-vbox:~$ sudo tail -2 /etc/shadow
student:$6$JjiTdyS2$cvbtxgVxMwMI5fL0If5Dc90JRuds9yolCKGHc/52ET1tLwksji/
           SN05pksqdwACztcvhIyCDRfAt9lrK133WA/:15935:0:99999:7:::
pjd:$6$wz5.BTqz$RXkmlCnbb0aoA7C67zf2zL7FokmdKLoc51MLdn7jcDe/JMHzs7iePBC
           NEy7O7ZGbVFIl4wTEbi5a8yhhQALnd1:15941:0:99999:7:::
</pre></div>
</div>
</div>
<p><strong>Challenge-response</strong>: This is another variation on password checking,
although it is typically used over a network rather than for direct
login. In this case the server must keep the password in clear text;
when a client requests authentication, the server sends a
<em>challenge</em>—a random string—which the client adds to the password
before hashing it and sending the result back to the server. In this way
an attacker with access to the network is unable to learn the password,
and (if the server never repeats challenges) is unable to replay
previous responses.</p>
</section>
<section id="centralized-authentication-ldap-and-kerberos">
<h3><span class="section-number">47.1.3. </span>Centralized authentication - LDAP and Kerberos<a class="headerlink" href="#centralized-authentication-ldap-and-kerberos" title="Permalink to this headline">#</a></h3>
<p>Modern computer systems frequently use centralized password
administration: for instance, when you log in to a CCIS workstation your
password is not checked locally, but rather against a central
authentication server. The most common used mechanisms are LDAP and
Kerberos, frequently used as part of Microsoft’s Active Directory
service. LDAP (lightweight directory access protocol) is a
general-purpose directory protocol that can store information about
people, machines, and just about anything else that a computer might
want to name; an example entry is shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:ldap</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="fig-ldap">
<div class="code-block-caption"><span class="caption-number">Listing 47.2 </span><span class="caption-text">Typical CCIS LDAP entry</span><a class="headerlink" href="#fig-ldap" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pjd, people, ccs.neu.edu</span>
          <span class="n">dn</span><span class="p">:</span> <span class="n">uid</span><span class="o">=</span><span class="n">pjd</span><span class="p">,</span><span class="n">ou</span><span class="o">=</span><span class="n">people</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">ccs</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">neu</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">edu</span>
          <span class="n">displayName</span><span class="p">:</span> <span class="n">Peter</span> <span class="n">J</span><span class="o">.</span> <span class="n">Desnoyers</span>
          <span class="n">cn</span><span class="p">:</span> <span class="n">pjd</span>
          <span class="n">loginShell</span><span class="p">:</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span>
          <span class="n">uidNumber</span><span class="p">:</span> <span class="mi">11415</span>
          <span class="n">gidNumber</span><span class="p">:</span> <span class="mi">65100</span>
          <span class="n">sn</span><span class="p">:</span> <span class="n">Desnoyers</span>
          <span class="n">homeDirectory</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pjd</span>
          <span class="n">mail</span><span class="p">:</span> <span class="n">pjd</span><span class="nd">@ccs</span><span class="o">.</span><span class="n">neu</span><span class="o">.</span><span class="n">edu</span>
          <span class="n">givenName</span><span class="p">:</span> <span class="n">Peter</span>
           <span class="o">...</span>
</pre></div>
</div>
</div>
<p>One of the attributes an LDAP entry can have is a password: a client can
log in to the LDAP server by specifying this password, which will be
checked by the server. A Linux or other system will use an LDAP server
for authentication by attempting to login with the credentials supplied
by the user; if this succeeds, then the local login is successful and
user information (such as shell and home directory) is retrieved from
the server<a class="footnote-reference brackets" href="#id17" id="id6">6</a>.</p>
<p>Kerberos is a more general-purpose authentication mechanism that allows
a server to supply unforgeable cryptographically-signed tickets. These
allow untrusted machines, like personal computers, to securely access
network services, such as a file server while only having to
authenticate once, to the Kerberos server; after this initial
authentication, the Kerberos tickets can be used for authentication
without having to request additional passwords from the user.</p>
</section>
</section>
<section id="unix-access-control">
<h2><span class="section-number">47.2. </span>Unix Access Control<a class="headerlink" href="#unix-access-control" title="Permalink to this headline">#</a></h2>
<p>Basic security in an operating system is performed by access control:
the process of determining whether each OS action will be allowed, based
on the actor (determined by information like a user ID), the specific
object (e.g. a file), and object permissions. The desired operation can
be described by an access control matrix, such as this one or four users, 3 files and 1 directory:</p>
<table class="table" id="fig-sec-simple">
<caption><span class="caption-number">Table 47.1 </span><span class="caption-text">Simple access matrix (again)</span><a class="headerlink" href="#fig-sec-simple" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>file1</p></th>
<th class="head"><p>file2</p></th>
<th class="head"><p>dir1</p></th>
<th class="head"><p>file3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>user1</p></td>
<td></td>
<td><p>read</p></td>
<td></td>
<td><p>read/write</p></td>
</tr>
<tr class="row-odd"><td><p>user2</p></td>
<td><p>read</p></td>
<td><p>read</p></td>
<td><p>read/write</p></td>
<td><p>read</p></td>
</tr>
<tr class="row-even"><td><p>user3</p></td>
<td><p>read</p></td>
<td><p>read</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>user4</p></td>
<td><p>read/write</p></td>
<td><p>read/write</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>To be more specific, the Unix security model has the following parts:</p>
<p><strong>Actors</strong>: Users. User identity (and file ownership) is described by
two IDs:</p>
<ol class="arabic simple">
<li><p>User id (<code class="docutils literal notranslate"><span class="pre">uid</span></code>)</p></li>
<li><p>Group id (<code class="docutils literal notranslate"><span class="pre">gid</span></code>)</p></li>
</ol>
<p>In addition there are permissions for <em>world</em>—i.e. any user.</p>
<p><strong>Objects</strong>: Files and directories.</p>
<p><strong>Actions:</strong> On files: <em>read</em>, <em>write</em>, and <em>execute</em> (i.e. run as a
program). Directories: <em>list</em> (as in <code class="docutils literal notranslate"><span class="pre">ls</span></code>), <em>traverse</em> - i.e. accessing
the file <code class="docutils literal notranslate"><span class="pre">/a/b/c</span></code> requires traversing the directories <code class="docutils literal notranslate"><span class="pre">/a</span></code> and <code class="docutils literal notranslate"><span class="pre">/a/b</span></code>,
and <em>modify</em> - i.e. creating, deleting, or renaming files (or
directories) within that directory. (note that list, traverse, and
modify are encoded as read, execute, and write permissions)</p>
<p>Users may belong to more than one group: as an example, user pjd belongs
to groups faculty, cs5600 and sssl, as shown here by the id command:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-number">Listing 47.3 </span><span class="caption-text">Id command output</span><a class="headerlink" href="#id7" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pjd@login:~$ id pjd
uid=11415(pjd) gid=65100(faculty) groups=1254(cs5600),1294(sssl),65100(faculty)
</pre></div>
</div>
</div>
<p>Files and directories have an owner and a group, and three sets of
permissions: one for the file owner, one for members of its group, and
one for world, with the permissions typically encoded in a single
string, as shown in <a class="reference internal" href="#fig-sec-lsdashl"><span class="std std-numref">Fig. 47.1</span></a>.</p>
<figure class="align-default" id="fig-sec-lsdashl">
<a class="reference internal image-reference" href="../_images/security-fig1.png"><img alt="../_images/security-fig1.png" src="../_images/security-fig1.png" style="width: 70%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 47.1 </span><span class="caption-text">Interpreting file ownership and permissions</span><a class="headerlink" href="#fig-sec-lsdashl" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Finally, (a) only the owner of a file may change its permissions, and
(b) each user may belong to some number of groups. (typically up to 32)</p>
<p>Permissions are interpreted as follows:</p>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-number">Listing 47.4 </span><span class="caption-text">File access algorithm</span><a class="headerlink" href="#id21" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check</span><span class="p">(</span><span class="n">process</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">process</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">uid</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">perm</span><span class="o">.</span><span class="n">owner</span>
            <span class="n">allow</span>
         <span class="k">else</span> <span class="n">deny</span>
      <span class="k">if</span> <span class="n">process</span><span class="o">.</span><span class="n">gid</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">gid</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">perm</span><span class="o">.</span><span class="n">group</span>
            <span class="n">allow</span>
         <span class="k">else</span> <span class="n">deny</span>
      <span class="k">if</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">perm</span><span class="o">.</span><span class="n">world</span><span class="p">:</span>
         <span class="n">allow</span>
      <span class="k">else</span> <span class="n">deny</span>
</pre></div>
</div>
</div>
<p>As an example, the access control matrix from earlier:</p>
<table class="table" id="id8">
<caption><span class="caption-number">Table 47.2 </span><span class="caption-text">Simple access matrix (again)</span><a class="headerlink" href="#id8" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>file1</p></th>
<th class="head"><p>file2</p></th>
<th class="head"><p>dir1</p></th>
<th class="head"><p>file3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>user1</p></td>
<td><p>-</p></td>
<td><p>read</p></td>
<td><p>-</p></td>
<td><p>read/write</p></td>
</tr>
<tr class="row-odd"><td><p>user2</p></td>
<td><p>read</p></td>
<td><p>read</p></td>
<td><p>read/write</p></td>
<td><p>read</p></td>
</tr>
<tr class="row-even"><td><p>user3</p></td>
<td><p>read</p></td>
<td><p>read</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>user4</p></td>
<td><p>read/write</p></td>
<td><p>read/write</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
<p>can be encoded in the set of permissions shown in
<span class="xref myst">[fig:sec:simple2]</span>{reference-type=”autoref”
reference=”fig:sec:simple2”}.</p>
<div class="highlight-{#fig:sec:simple2 notranslate"><div class="highlight"><pre><span></span>group1 = {user2,user3,user4}
file1:  owner = user4, group = group1
                permissions = {owner = &#39;rw-&#39;, group = &#39;r--&#39;, other = &#39;---&#39;}
file2:  owner = user4, group = [doesn&#39;t matter]
        permissions = {owner = &#39;rw-&#39;, group = &#39;r--&#39;, other = &#39;r--&#39;}
dir1:   owner = user2, group = [doesn&#39;t matter]
                permissions = {owner = &#39;rw-&#39;, group = &#39;---&#39;, other = &#39;---&#39;}
group2 = {user1,user2}
file3:  owner = user1, group = group2
                permissions = {owner = &#39;rw-&#39;, group = &#39;r--&#39;, other = &#39;---&#39;}
</pre></div>
</div>
<section id="limitations-of-unix-permissions">
<h3><span class="section-number">47.2.1. </span>Limitations of Unix permissions<a class="headerlink" href="#limitations-of-unix-permissions" title="Permalink to this headline">#</a></h3>
<p>However if we make minor changes to this access control list:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>       file1   file2   dir1   file3
</pre></div>
</div>
<hr class="docutils" />
<p>user1    —     r–    —     rw-
user2    r–     r–    rw–    r–
user3    rw-     r–    —     rwx
user4    rw-     rw-    —     —</p>
<p>: Complex access matrix (<code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-l</span></code> notation used for conciseness)</p>
<p>There are two problems here:</p>
<p><code class="docutils literal notranslate"><span class="pre">file1</span></code>: Here two users have the highest level of privilege. If <code class="docutils literal notranslate"><span class="pre">user3</span></code>
and <code class="docutils literal notranslate"><span class="pre">user4</span></code> are assigned to the same group, and the <code class="docutils literal notranslate"><span class="pre">file1</span></code> owner and
group permission are both set to <code class="docutils literal notranslate"><span class="pre">rw-</span></code>, then the only permission left is
“world”. If that is set to <code class="docutils literal notranslate"><span class="pre">—</span></code> then <code class="docutils literal notranslate"><span class="pre">user2</span></code> will not have the read
access specified in the access control matrix; however if it is set to
<code class="docutils literal notranslate"><span class="pre">r–</span></code> then <code class="docutils literal notranslate"><span class="pre">user1</span></code> will improperly have access<a class="footnote-reference brackets" href="#id18" id="id9">7</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">file3</span></code>: Here there are 4 distinct combinations of permissions, while
Unix permissions for a single file can only hold 3 combinations (owner,
group, and world).</p>
</section>
<section id="access-control-lists">
<h3><span class="section-number">47.2.2. </span>Access Control Lists<a class="headerlink" href="#access-control-lists" title="Permalink to this headline">#</a></h3>
<p>Access Control Lists (ACLs) are explicit rules granting or denying
access to users, and are more powerful than simple permissions. The idea
is straightforward: an ACL is a list of rules, where each rule specifies
a user or group, an action, and whether to allow or deny permissions.</p>
<p>Using the same example, which could not be encoded in standard Unix
permissions:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>            file1   file2   dir1    file3
    user1   ---     r--     ---     rw-
    user2   r--     r--     rw-     r--
    user3   rw-     r--     ---     rwx
    user4   rw-     rw-     ---     ---
</pre></div>
</div>
<p>the desired access to <code class="docutils literal notranslate"><span class="pre">file1</span></code> can be expressed as:</p>
<div class="highlight-{framexleftmargin=&quot;12pt&quot; notranslate"><div class="highlight"><pre><span></span>file1:      owner = user4, group = {user4,user3}
        owner: rw-, group: rw-, user2: r--, other: ---
file3:      owner = user3, group = {user3, user1}
        owner: rwx, group: rw-, user2: r--, other: ---
</pre></div>
</div>
</section>
<section id="access-control-list-examples">
<h3><span class="section-number">47.2.3. </span>Access Control List Examples<a class="headerlink" href="#access-control-list-examples" title="Permalink to this headline">#</a></h3>
<p>This example uses OSX access control lists; however, Linux and Windows
have similar mechanisms. We start with three user IDs: <code class="docutils literal notranslate"><span class="pre">pjd</span></code>, <code class="docutils literal notranslate"><span class="pre">guest</span></code>,
and <code class="docutils literal notranslate"><span class="pre">joe</span></code>.</p>
<p>First a file is created, made readable by all users, and an ACL rule is
added denying access to user joe (using the chmod —a command).</p>
<p>The file can now be read by both <code class="docutils literal notranslate"><span class="pre">pjd</span></code> and <code class="docutils literal notranslate"><span class="pre">guest</span></code>, but not <code class="docutils literal notranslate"><span class="pre">joe</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pjd$ cat file.1
file 1 contents
joe$ cat file.1
cat: file.1: Permission denied
guest$ cat file.1
file 1 contents
</pre></div>
</div>
<p>Now we create a second file, set it owner read-only, and a rule is added
giving read access to <code class="docutils literal notranslate"><span class="pre">joe</span></code> but no other user:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pjd$ echo &#39;file 2 contents&#39; &gt; file.2        
pjd$ chmod u=r,g=,o= file.2 
pjd$ ls -le file.2
 -r--------+ 1 pjd  wheel  16 Aug 28 14:20 file.2
     0: user:joe allow read 
</pre></div>
</div>
<p>Now the file can be read by <code class="docutils literal notranslate"><span class="pre">pjd</span></code> and <code class="docutils literal notranslate"><span class="pre">joe</span></code> but not <code class="docutils literal notranslate"><span class="pre">guest</span></code>:</p>
</section>
<section id="other-privileged-operations">
<h3><span class="section-number">47.2.4. </span>Other Privileged Operations<a class="headerlink" href="#other-privileged-operations" title="Permalink to this headline">#</a></h3>
<p>Most Linux security checking is handled by a combination of the
following rules:</p>
<div class="highlight-compactitem notranslate"><div class="highlight"><pre><span></span>File system permissions

Signal permissions. A non-root process can only signal processes with
the same user ID.

Super-user. User ID 0 (traditionally named &quot;root&quot;) may access any file
or signal any process; dangerous kernel operations can only be performed
if the current user id is 0.

Set UID. This allows users to invoke functions with elevated privileges
when appropriate.
</pre></div>
</div>
<p>Most security checking in Linux / Unix is handled by file system
permissions. As an example, system utilities need direct access to the
disk (e.g. to format a new file system); normal users are prevented from
reformatting the disk by the permissions on the special file
representing the disk device (e.g. <code class="docutils literal notranslate"><span class="pre">/dev/sd0</span></code>)</p>
<p>Unix signals are primarily used to kill a process, and so are only
allowed between processes with the same user ID.</p>
<p>User ID number 0 (traditionally given the username “root”) is allowed to
bypass all user id-based permissions. In addition, certain system calls
(e.g. mount a file system, reboot, install a kernel module) may only be
performed by the super-user.</p>
<p>Finally, the setuid permission flag on a file tells the kernel that when
the file is executed it should take on the identity of the file’s owner,
not the user who invoked it. This is a simple mechanism which allows
programs to make finer distinctions than the kernel does. For instance
the <code class="docutils literal notranslate"><span class="pre">mount</span></code> program is owned by user “root”, and marked <em>setuid</em>, as
under certain circumstances a normal user may be allowed to mount a
filesystem (e.g. when it is a removable drive). When the program is run
by a normal user, it checks configuration files to see whether the
request is authorized; if so it is able to invoke the mount system call
as user ID root.</p>
</section>
</section>
<section id="selinux">
<h2><span class="section-number">47.3. </span>SELinux<a class="headerlink" href="#selinux" title="Permalink to this headline">#</a></h2>
<p>An alternate security mechanism available in Linux is called SELinux, or
Security-Enhanced Linux. This is an enhancement to the normal Linux
security model, which allows for exceptions to normal Linux rules. As an
example, normal file permissions can still deny access to a file, but in
cases where permissions allow access, SELinux rules might still forbid
it.</p>
<p>SELinux is based on rules about <em>domains</em> and <em>types</em>. A domain is an
execution environment that users run programs in; a set of rules for a
domain determine which users can run what programs within that domain.
Files have types, and rules determine which domains are able to access
which types of files. Finally, users can change domains by running
certain programs; when this occurs is again determined by
(unsurprisingly) another set of rules.</p>
<p>Rules are loaded into the kernel by a user-space policy process, and
file types are determined by an SELinux context associated with the
file, stored in file <em>extended attributes</em> in the file inode.</p>
<p>As an example, the password file <span class="xref download myst">/etc/passwd</span>{.uri}
contains usernames, groups, home directories, but not the hashed
passwords themselves, which are in the shadow file,
<span class="xref download myst">/etc/shadow</span>{.uri}; the shadow file may be modified when
users run the <span class="xref download myst">/usr/bin/passwd</span>{.uri} program:</p>
<div class="highlight-{basicstyle=&quot;\\ttfamily\\scriptsize&quot; notranslate"><div class="highlight"><pre><span></span>[root@localhost ~]# ls -Z /etc/passwd /etc/shadow /usr/bin/passwd
-rw-r--r--  root   root   system_u:object_r:etc_t          /etc/passwd
-r--------  root   root   system_u:object_r:shadow_t      /etc/shadow
-r-s--x--x  root   root   system_u:object_r:passwd_exec_t /usr/bin/passwd
</pre></div>
</div>
<p>One SELinux policy rule states that a user enters the
<span class="xref myst">passwd_t</span>{.uri} domain when executing a file of type
<span class="xref myst">passwd_exec_t</span>{.uri}; another states that processes
running in the <span class="xref myst">passwd_t</span>{.uri} domain have read and write
privileges to files of type <span class="xref myst">shadow_t</span>{.uri}. If SELinux is
enabled, then even the superuser will only be able to modify
<span class="xref download myst">/etc/shadow</span>{.uri} (and update your password) by executing
<span class="xref download myst">/usr/bin/passwd</span>{.uri} or another executable marked
<span class="xref myst">passwd_exec_t</span>{.uri}.</p>
<p>Actual SELinux policies are extremely complex, containing hundreds of
rules; if you are interested in finding out more there are a number of
tutorials on the Internet, including
<a class="reference external" href="http://www.centos.org/docs/5/html/Deployment_Guide-en-US/ch-selinux.html">http://www.centos.org/docs/5/html/Deployment_Guide-en-US/ch-selinux.html</a></p>
<section id="control-of-information-flow">
<h3><span class="section-number">47.3.1. </span>Control of Information Flow<a class="headerlink" href="#control-of-information-flow" title="Permalink to this headline">#</a></h3>
<p>File access control is (somewhat) straightforward for an operating
system to provide, as it represents a simple decision. If access is
allowed, then the requested operation proceeds without interference; if
it is denied, then the request fails completely.</p>
<p>In many cases, however, the desired restrictions are more subtle.
Perhaps the earliest published example was a simple computer guessing
game; the program would need to access the data to be guessed, while
preventing the user from accessing it directly. Simple file permissions
would not work, as if the game program were able to access the data
file, then other programs (e.g. an editor) would be able to as well,
allowing users to cheat.</p>
<p>In general such a problem requires interposing higher-layer software
between the user and the protected information. In Unix the <em>setuid</em>
mechanism allows a user A to run a program as a different user B (e.g.
root), by having the executable file owned by user B and setting the
<em>setuid</em> permission on the file. This can be done in a way that user B
has full access to the protected data, allowing the program to access
the data on behalf of user A, but only in ways allowed by the program
logic.</p>
<p>In modern systems it is more common for such a gatekeeper role to be
played by a server with access to the data, which accepts requests from
users via messages and makes decisions on what data to reveal. Some
examples:</p>
<p><strong>MySQL</strong>: This database accepts connections over a TCP socket; users
log in and then are able to read and modify those tables they have been
given permission to access, regardless of which files the data resides
in. The MySQL process runs under a separate user ID, which is the only
one able to access the underlying data.</p>
<p><strong>Blackboard</strong>: Connections to Blackboard are web sessions, controlled
directly by users, and isolation of the data itself is ensured by
preventing user access to the system that Blackboard runs on. The
application logic enforces a complex set of rules governing what
information each user may access; thus an instructor may see all grades,
while a student may only see aggregate information (e.g. averages) about
other students’ grades.</p>
<section id="review-questions">
<h4><span class="section-number">47.3.1.1. </span>Review Questions<a class="headerlink" href="#review-questions" title="Permalink to this headline">#</a></h4>
<div class="highlight-enumerate notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="attacks-stack-overflow">
<h2><span class="section-number">47.4. </span>Attacks — Stack Overflow<a class="headerlink" href="#attacks-stack-overflow" title="Permalink to this headline">#</a></h2>
<div class="highlight-wrapfigure notranslate"><div class="highlight"><pre><span></span>r0in ![image](figures/security-fig2){height=&quot;14\\baselineskip&quot;}
</pre></div>
</div>
<p>In <span class="xref myst">[fig:security:worm]</span>{reference-type=”autoref”
reference=”fig:security:worm”} you can see a fragment of code that was
attacked (among others) by the first piece of Internet malware, the 1988
Morris worm. The target program (<code class="docutils literal notranslate"><span class="pre">fingerd</span></code>) was run with a network
connection for its standard input, and used the <code class="docutils literal notranslate"><span class="pre">gets</span></code> function to read
a line of input into a buffer on the stack; it would normally return a
simple reply based on that input and then exit. <code class="docutils literal notranslate"><span class="pre">Gets</span></code> reads a line from
standard input, reading as many bytes as it takes before it finds a
newline or reaches end-of-file. The buffer used, located at a lower
address on the stack than the return address, was 512 bytes long, but
the worm sent a 537-byte single-line message consisting of machine code,
ending with a carefully chosen return address pointing at the beginning
of the injected code. Since <code class="docutils literal notranslate"><span class="pre">fingerd</span></code> was run as the root user, the
result was that when the function returned, the malware code had full
control of the machine. In the years since, many lessons have been
learned about preventing this sort of attack:</p>
<ul class="simple">
<li><p>(application writers) Do not use <code class="docutils literal notranslate"><span class="pre">gets</span></code> or other functions which can
overrun a fixed-length buffer. (e.g. <code class="docutils literal notranslate"><span class="pre">fgets</span></code> takes the buffer length
as an argument)</p></li>
<li><p>(OS writers) Randomize the location of the stack and libraries each
time a program is run, to make it more difficult to guess where an
attack should return to.</p></li>
<li><p>(OS writers) Use the NX (“no execute”) page table bit on modern
processors to prevent code on the stack from being executed.</p></li>
</ul>
<p>Unfortunately buffer overflow vulnerabilities are still alive and well,
as more sophisticated attacks have been developed to counter these
techniques, as long as there is an initial application bug to give
access to the stack. <a class="footnote-reference brackets" href="#id19" id="id10">8</a></p>
<section id="security-sql-injection">
<h3><span class="section-number">47.4.1. </span>Security - SQL Injection<a class="headerlink" href="#security-sql-injection" title="Permalink to this headline">#</a></h3>
<p><img alt="Image by Randall Munroe, from Xkcd: http://xkcd.com/327/, licensedunder creative commons non-commercial license 2.5" src="sec/figures/security-xkcd.pdf" />{#fig:security:xkcd width=”80%”}</p>
<p>What happened to Bobby’s school’s student database? Let’s assume they
used code like this Visual Basic fragment, adapted from an example on an
MSDN discussion board. (’&amp;’ concatenates strings in VB):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmd</span><span class="o">.</span><span class="n">commandText</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO Students (Name) VALUES (&#39;&quot;</span> \<span class="o">&amp;</span> <span class="n">studentName</span> \<span class="o">&amp;</span> <span class="s2">&quot;&#39;);&quot;</span>
<span class="n">cmd</span><span class="o">.</span><span class="n">executeNonQuery</span><span class="p">()</span>
</pre></div>
</div>
<p>So if studentName=”Joey Smith”, the following SQL command will be
executed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>``INSERT INTO Students (Name) VALUES(&#39;Joey Smith&#39;);&quot;
</pre></div>
</div>
<p>But if studentName=”Robert’); DROP TABLE Students;–”, we get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>``INSERT INTO Students (Name) VALUES(&#39;Robert&#39;); DROP TABLE Students;--);&#39;&#39;
</pre></div>
</div>
<p>Semicolon (“;”) is the command separator in SQL, and “” is a comment
marker causing the rest of the line to be ignored; after adding ‘Robert’
to the Students table, the DROP TABLE command will be executed, removing
the entire table.</p>
</section>
<section id="ssl-and-connection-security">
<h3><span class="section-number">47.4.2. </span>SSL and Connection Security<a class="headerlink" href="#ssl-and-connection-security" title="Permalink to this headline">#</a></h3>
<p>Secure Sockets Layer (SSL) allows two systems to establish a connection
that cannot be intercepted, even by an adversary who observes every
packet sent by both systems. Most importantly, it does not require any
shared encryption key to be used by both systems<a class="footnote-reference brackets" href="#id20" id="id11">9</a>. SSL relies on a
combination of private- and public-key encryption:</p>
<ul class="simple">
<li><p>Private-key encryption uses a private key to encrypt a message,
which may then be decrypted using the same private key.</p></li>
<li><p>Public-key encryption uses two keys: (a) A public key to encrypt the
message, and (b) a separate private key which must be used to
decrypt it. In one of today’s public-key systems, the public key is
the product of two large prime numbers, and the private key is the
two numbers themselves. The private key can be derived from the
public key by factoring it, but for large numbers this is believed
to be prohibitively difficult to actually do.</p></li>
</ul>
<p>The simplest use of public-key encryption to provide a private
connection would be for the two systems to each have public/private key
pairs, send each other their public keys, and then encrypt traffic with
the other system’s public key. Unfortunately, public-key encryption is
very computationally expensive, so instead SSL uses the following steps,
sometimes called the SSL handshake:</p>
<ol class="arabic simple">
<li><p>The client connects to the server</p></li>
<li><p>The server sends its public key to the client</p></li>
<li><p>The client chooses a random number, encrypts it with the public key, and
sends it to the server, which then decrypts it.</p></li>
</ol>
<p>Client and server both use this random number as the key to a
private-key code — all outgoing messages are encrypted using this key,
and all incoming messages are decrypted with it. There are additional
aspects of the SSL protocol to guard against impersonation and
“man-in-the-middle” attacks, which are somewhat more complicated and are
not covered here.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>E.g. see courses such as CS 5770, Software Vulnerabilities and
Security, CS 6750, Cryptography and Communication Security, CS 6740,
Network Security, or CS 6760, Privacy, Security and Usability</p>
</dd>
<dt class="label" id="id13"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Additional identities are typically used for <em>system accounts</em>,
like the <code class="docutils literal notranslate"><span class="pre">httpd</span></code> user associated with the webserver process on many
systems. This allows the same mechanism to be used to grant or
restrict access for various system operations.</p>
</dd>
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Typically, the password is used as a key to encrypt a known,
constant message.</p>
</dd>
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Typically common words, plus personal names, plus variations on
those words such as appending a digit.</p>
</dd>
<dt class="label" id="id16"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>see
[<a class="reference external" href="https://engineering.purdue.edu/kak/compsec/NewLectures/">https://engineering.purdue.edu/kak/compsec/NewLectures/</a> Lecture24.pdf](<a class="reference external" href="https://engineering.purdue.edu/kak/compsec/NewLectures/">https://engineering.purdue.edu/kak/compsec/NewLectures/</a> Lecture24.pdf){.uri}</p>
</dd>
<dt class="label" id="id17"><span class="brackets"><a class="fn-backref" href="#id6">6</a></span></dt>
<dd><p>In Linux and some other systems this is handled in practice by the
PAM (pluggable authentication module) framework, developed at Sun
Microsystems, which specifies one or more authentication sources for
the system to try for various events such as login.</p>
</dd>
<dt class="label" id="id18"><span class="brackets"><a class="fn-backref" href="#id9">7</a></span></dt>
<dd><p>Although it’s possible to achieve this matrix with
owner=[<code class="docutils literal notranslate"><span class="pre">user2</span> <span class="pre">r–</span></code>], group=[<code class="docutils literal notranslate"><span class="pre">(user2,user3,user4)</span> <span class="pre">rw-</span></code>], and
world=[<code class="docutils literal notranslate"><span class="pre">—</span></code>], it doesn’t really make sense since the owner can gain
write access just by changing permissions on the file.</p>
</dd>
<dt class="label" id="id19"><span class="brackets"><a class="fn-backref" href="#id10">8</a></span></dt>
<dd><p>If you are interested in learning more about stack overflows,
there is a good tutorial at
<a class="reference external" href="http://www.tenouk.com/cncplusplusbufferoverflow.html">http://www.tenouk.com/cncplusplusbufferoverflow.html</a></p>
</dd>
<dt class="label" id="id20"><span class="brackets"><a class="fn-backref" href="#id11">9</a></span></dt>
<dd><p>In most cases using a shared private key doesn’t solve the
problem: before you use it, you have to figure out how to securely
communicate the private key.</p>
</dd>
</dl>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./sec"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../virt/virt.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">46. </span>Virtualization</p>
      </div>
    </a>
    <a class="right-next"
       href="../misc/howto.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">48. </span>How to read this book</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#protection">47.1. Protection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identity-and-authentication">47.1.1. Identity and Authentication</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-passwords">47.1.2. Checking passwords</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#centralized-authentication-ldap-and-kerberos">47.1.3. Centralized authentication - LDAP and Kerberos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unix-access-control">47.2. Unix Access Control</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations-of-unix-permissions">47.2.1. Limitations of Unix permissions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-control-lists">47.2.2. Access Control Lists</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-control-list-examples">47.2.3. Access Control List Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#other-privileged-operations">47.2.4. Other Privileged Operations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selinux">47.3. SELinux</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#control-of-information-flow">47.3.1. Control of Information Flow</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#review-questions">47.3.1.1. Review Questions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attacks-stack-overflow">47.4. Attacks — Stack Overflow</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#security-sql-injection">47.4.1. Security - SQL Injection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ssl-and-connection-security">47.4.2. SSL and Connection Security</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By (see contributing chapter book)
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>